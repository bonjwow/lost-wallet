---
title: "TBD"
subtitle: "TBD"
author: "Bongju Yoo and Najma Osman"
thanks: "Code and data are available at: https://github.com/bonjwow/lost-wallet"
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
output:
  bookdown::pdf_document2:
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(ggalt)
library(ggthemes)
library(kableExtra)
library(janitor)
library(dplyr)
library(olsrr)

### Import the cleaned data
dfCleanBehav <- readr::read_csv("../../inputs/data/clean_behavioral-data.csv")
dfBehavModel <- readr::read_csv("../../inputs/data/clean_behavioral-data_model.csv")
```

# Introduction



# Data

```{r, echo = FALSE, message = FALSE}
### All wallets with no money
dfNoMoney <- 
  dfCleanBehav %>%
  filter(cond == 0) %>%
  group_by(country_2) %>%
  tally()

### All wallets with money
dfMoney <- 
  dfCleanBehav %>%
  filter(cond == 1) %>%
  group_by(country_2) %>%
  tally()

### Returned wallets with no money
dfReturnedNoMoney <-
  dfCleanBehav %>%
  filter(cond == 0 & response == 100) %>%
  group_by(country_2) %>%
  tally()

### Returned wallets with money
dfReturnedMoney <-
  dfCleanBehav %>%
  filter(cond == 1 & response == 100) %>%
  group_by(country_2) %>%
  tally()

### Merge all wallets and returned wallets with no money
dfMergedNoMoney <-
  merge(x = dfNoMoney, y = dfReturnedNoMoney, by = "country_2", all.x = TRUE) %>%
  mutate(rating = round(n.y / n.x * 100, 2)) %>%
  rename(country = "country_2") %>%
  rename(total = "n.x") %>%
  rename(returned = "n.y")

### Merge all wallets and returned wallets with money
dfMergedMoney <-
  merge(x = dfMoney, y = dfReturnedMoney, by = "country_2", all.x = TRUE) %>%
  mutate(rating = round(n.y / n.x * 100, 2)) %>%
  rename(country = "country_2") %>%
  rename(total = "n.x") %>%
  rename(returned = "n.y")
  
```


```{r, echo = FALSE, message = FALSE}

### Dumbbell Plot
dfRatings <- 
  data.frame(country = dfMergedNoMoney$country,
             noMoney = dfMergedNoMoney$rating,
             money = dfMergedMoney$rating) %>%
  arrange(desc(noMoney))

### Reorder factor levels
dfRatings$country <- reorder(dfRatings$country, dfRatings$noMoney)

ggplot(dfRatings, aes(y = country, x = noMoney, xend = money)) +
  geom_dumbbell(size = 2, 
                color = "#e3e2e1",
                colour_x = "#FFA500", 
                colour_xend = "#FF0000",
                dot_guide = TRUE, 
                dot_guide_size = 0.05,
                show.legend = TRUE) +
                # TODO: Fix legend 
  labs(x = NULL, y = NULL, title = "Share of wallets reported by country") +
  theme_minimal() +
  scale_color_manual(name = "", values = c("red", "blue") ) +
  theme(panel.grid.major.x = element_line(size = 0.02))

```



## Description of Study

## Methodology and Data Collection



# Model

```{r S8, echo = FALSE, message = FALSE}

### OLS formula : y = mx + c, where 
### y = response (dependent variable) - so report/no report,
### m = slope
### x = independent variable, predictor - condition (no money, money, big money)
### c = the intercept
s8_money <-
  dfBehavModel %>%
  filter(cond == 1 | cond == 2 | cond == 3)
ols_regress(response ~ cond + male + age + computer + coworkers + other_bystanders, data = s8_money)

s8_no_money <-
  dfBehavModel %>%
  filter(cond == 0)
ols_regress(response ~ cond + male + age + computer + coworkers + other_bystanders, data = s8_no_money)


# need to control for treatment + institution + city 
```

```{r S9, echo = FALSE, message = FALSE}

```


# Results



# Discussion

## Overview of Findings

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

# Appendix {-}

\newpage


# References


